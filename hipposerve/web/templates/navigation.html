<nav class="border-bottom mb-2 p-2 d-flex flex-wrap justify-content-between align-items-center">
    <div class="d-flex align-items-center gap-3">
      <div title="Click to return to home page">
        <a class="nav-link color-light" href="/web">
          <img alt="HIPPO logo" src="/web/static/logo.svg" width="55" height="auto" />
        </a>
      </div>
      <form
        role="search"
        action="/web/search/results"
        method="get"
        style="min-width: 400px; max-width: 750px"
      >
        <div class="input-group input-group-sm">
          <div
            class="position-relative"
            style="height: 40px; min-height: 40px;"
          >
            <label
              class="small position-absolute opacity-50"
              for="search-filter"
              style="top: 2px; left: 10px;"
            >
              Filter by:
            </label>
            <select
              class="form-select form-select-sm rounded-0 rounded-start-2"
              id="search-filter"
              style="height: 100%; padding-top: 15px;"
              name="filter"
              onchange="onFilterChange(event)"
            >
              <option value="products" {% if filter == "products" %}selected{% endif %}>Products</option>
              <option value="collections" {% if filter == "collections" %}selected{% endif %}>Collections</option>
              <option value="users" {% if filter == "users" %}selected{% endif %}>Users</option>
              <option value="sources" {% if filter == "sources" %}selected{% endif %}>Sources</option>
            </select>
          </div>
          <label for="search-bar" class="visually-hidden">Search:</label>
          <input
            class="form-control"
            type="search"
            id="search-bar"
            name="q"
            style="flex-grow: 2;"
            value="{{ '' if query is none else query }}"
          >
          <button class="btn btn-dark btn-sm" type="submit">Search</button>
        </div>
      </form>
    </div>
    <ul class="nav gap-4 align-items-center">
      <li class="nav-item">
        <a class="nav-link p-0" href="/web/searchmetadata">Search by metadata</a>
      </li>
      <li class="nav-item">
        {% if user %}
          <a class="nav-link p-0" href="/web/user">
            <img class="border rounded-circle" src="{{ user.avatar_url }}" alt="User's GitHub avatar" width="45" height="auto"/>
          </a>
        {% else %}
          <a class="nav-link p-0" href="/web/login">
            Log in
          </a>
        {% endif %}
      </li>
    </ul>
  </nav>

  {% block scripts %}
    <script>
      let selectedFilter = '';
      
      document.addEventListener('DOMContentLoaded', () => {
        if (selectedFilter.length) {
          return;
        } else {
          selectedFilter = 'products';
          setPlaceholder();
        }
      })

      function setPlaceholder() {
        const inputEl = document.querySelector('#search-bar');
        inputEl.placeholder = "Search by " + selectedFilter.substring(0, selectedFilter.length - 1) + " names...";
      }

      function onFilterChange(e) {
        selectedFilter = e.target.value;
        setPlaceholder();
      }

    </script>
  {% endblock %}